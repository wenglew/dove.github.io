<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Linux—搭建Web服务器</title>
    <url>/2020/02/23/Linux%E2%80%94%E6%90%AD%E5%BB%BAWeb%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Linux搭建Web服务器"><a href="#Linux搭建Web服务器" class="headerlink" title="Linux搭建Web服务器"></a>Linux搭建Web服务器</h1><h2 id="1-web服务器简介"><a href="#1-web服务器简介" class="headerlink" title="1.web服务器简介"></a><a href="https://baike.baidu.com/item/WEB%E6%9C%8D%E5%8A%A1%E5%99%A8/8390210?fr=aladdin" target="_blank" rel="noopener">1.web服务器简介</a></h2><h2 id="2-配置文件解析"><a href="#2-配置文件解析" class="headerlink" title="2.配置文件解析"></a>2.配置文件解析</h2><h3 id="1-安装httpd服务"><a href="#1-安装httpd服务" class="headerlink" title="1).安装httpd服务"></a>1).安装httpd服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum <span class="literal">-y</span> install httpd</span><br></pre></td></tr></table></figure></div>
<h3 id="2-启动httpd服务"><a href="#2-启动httpd服务" class="headerlink" title="2).启动httpd服务"></a>2).启动httpd服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">systemctl start httpd</span><br><span class="line">lsof <span class="literal">-i</span>:<span class="number">80</span>		//查看<span class="number">80</span>端口是否开启</span><br></pre></td></tr></table></figure></div>
<h3 id="3-各配置文件目录"><a href="#3-各配置文件目录" class="headerlink" title="3).各配置文件目录"></a>3).各配置文件目录</h3><p><font face="微软雅黑" size="3">服务目录：/etc/httpd/<br>主配置文件：/etc/httpd/conf/httpd.conf<br>网页目录：/var/www/html/<br>服务脚本：/etc/init.d/httpd<br>执行程序：/usr/sbin/httpd</font></p>
<h3 id="4-查看主配置文件"><a href="#4-查看主配置文件" class="headerlink" title="4).查看主配置文件"></a>4).查看主配置文件</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">53</span>:<span class="number">44</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /etc/httpd/conf/httpd.conf</span><br><span class="line"></span><br><span class="line">	.....</span><br><span class="line">ServerRoot <span class="string">"/etc/httpd"</span> 	//Apache根目录</span><br><span class="line">	......</span><br><span class="line">Listen <span class="number">80</span>		//服务端口</span><br><span class="line">	......</span><br><span class="line">ServerAdmin root@localhost		//管理员邮箱地址，当网页发生错误时会发邮件给此邮箱</span><br><span class="line">	......</span><br><span class="line">ServerName www.example.com			//设置域名</span><br><span class="line">	......</span><br><span class="line">&lt;Directory /&gt;						//根目录权限设置</span><br><span class="line">    AllowOverride none				//设置禁止使用控制文件，默认为.htacces文件</span><br><span class="line">    Require all denied				//禁止所以的用户访问</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line">	......</span><br><span class="line">DocumentRoot <span class="string">"/var/www/html"</span>			//默认站点目录</span><br><span class="line">&lt;Directory <span class="string">"/var/www"</span>&gt;</span><br><span class="line">    AllowOverride None</span><br><span class="line">    <span class="comment">#Allow open access:			  </span></span><br><span class="line">    Require all granted				//允许所以用户访问</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line">    .......</span><br></pre></td></tr></table></figure></div>
<h2 id="3-Apache服务搭建"><a href="#3-Apache服务搭建" class="headerlink" title="3.Apache服务搭建"></a>3.Apache服务搭建</h2><h3 id="1-实现域名访问"><a href="#1-实现域名访问" class="headerlink" title="1).实现域名访问"></a>1).实现域名访问</h3><p><font size="4">(1).编辑子配置文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">53</span>:<span class="number">44</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /etc/httpd/conf.d/httpd<span class="literal">-vhosts</span>.conf</span><br><span class="line"></span><br><span class="line">&lt;VirtualHost *:<span class="number">80</span>&gt;			//使用的端口</span><br><span class="line">	ServerName www.test.com		//使用此域名	</span><br><span class="line">	DocumentRoot <span class="string">"/var/www/html"</span></span><br><span class="line">	&lt;Directory <span class="string">"/var/www/html"</span>&gt;	</span><br><span class="line">		&lt;Requireall&gt;</span><br><span class="line">			Require all granted			//允许所有用户访问</span><br><span class="line">            <span class="comment">#Require not ip 192.168.3.2		//此ip不能访问(黑名单)</span></span><br><span class="line">          	<span class="comment">#Require ip 192.168.3.3	//只允许此用户访问(白名单)</span></span><br><span class="line">		&lt;/Requireall&gt;</span><br><span class="line">	&lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(2).编辑站点文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">53</span>:<span class="number">44</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /var/www/html/index.html		</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;this is test server&lt;h1&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(3).域名ip绑定为本地主机ip,并设置DNS</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">53</span>:<span class="number">44</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /var/named/test.com.zone </span><br><span class="line"></span><br><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com.   admin.test.com.(</span><br><span class="line">                                        <span class="number">0</span>       ; serial</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh</span><br><span class="line">                                        <span class="number">1</span>H      ; retry</span><br><span class="line">                                        <span class="number">1</span>W      ; expire</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum</span><br><span class="line">        <span class="keyword">IN</span>      NS      www.test.com.</span><br><span class="line">www     <span class="keyword">IN</span>      A       <span class="number">192.168</span>.<span class="number">3.3</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">59</span>:<span class="number">53</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /etc/resolv.conf </span><br><span class="line"></span><br><span class="line">; generated by /usr/sbin/dhclient<span class="literal">-script</span></span><br><span class="line">nameserver <span class="number">192.168</span>.<span class="number">3.3</span></span><br><span class="line">nameserver <span class="number">183.60</span>.<span class="number">83.19</span></span><br></pre></td></tr></table></figure></div>
<p><font size="5"><strong>测试</strong></font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">27</span>:<span class="number">25</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> systemctl restart httpd.service		//重启服务</span><br><span class="line">[<span class="number">11</span>:<span class="number">28</span>:<span class="number">01</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> systemctl restart named.service</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">01</span>:<span class="number">37</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> curl www.test.com</span><br><span class="line">&lt;h1&gt;<span class="number">66666</span>&lt;h1&gt;</span><br></pre></td></tr></table></figure></div>
<h3 id="2-实现用户认证访问"><a href="#2-实现用户认证访问" class="headerlink" title="2).实现用户认证访问"></a>2).实现用户认证访问</h3><p><font size="4">(1).创建用户及用户组站点目录</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">10</span>:<span class="number">11</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> useradd admin1</span><br><span class="line">[<span class="number">11</span>:<span class="number">16</span>:<span class="number">25</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> useradd admin2</span><br><span class="line">[<span class="number">11</span>:<span class="number">16</span>:<span class="number">29</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> mkdir /var/www/html/admin</span><br><span class="line">[<span class="number">11</span>:<span class="number">16</span>:<span class="number">37</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /var/www/html/admin/index.html</span><br><span class="line"></span><br><span class="line">welcome!</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(2).配置文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">&lt;VirtualHost *:<span class="number">80</span>&gt;</span><br><span class="line">        ServerName www.wl.com</span><br><span class="line">        DocumentRoot <span class="string">"/var/www/html/admin"</span>		//用户组站点目录</span><br><span class="line">        &lt;Directory <span class="string">"/var/www/html/admin"</span>&gt;</span><br><span class="line">                        AllowOverride none</span><br><span class="line">                        AuthType Basic			//基于Basic认证</span><br><span class="line">                        AuthName <span class="string">"please login"</span>		//认证时显示的信息</span><br><span class="line">                        AuthUserfile <span class="string">"/etc/httpd/conf/.htpasswd"</span>	//认证是用户账号密码文件</span><br><span class="line">                        AuthGroupfile <span class="string">"/etc/httpd/conf/.htgroup"</span>	//基于组的认证</span><br><span class="line">                        Require group admin 		//admin组内的都可以访问</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(3).配置用户及密码</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">29</span>:<span class="number">56</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> htpasswd <span class="literal">-b</span> <span class="literal">-c</span> <span class="literal">-m</span> /etc/httpd/conf/.htpasswd admin1 Centos //为用户admin1创建以Centos为密码的文件，<span class="literal">-c</span>表示覆盖原来的文件内容</span><br><span class="line">[<span class="number">11</span>:<span class="number">30</span>:<span class="number">11</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> htpasswd <span class="literal">-b</span> <span class="literal">-m</span> /etc/httpd/conf/.htpasswd admin2 Centos</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(4).编辑组文件和密码文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">38</span>:<span class="number">52</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /etc/httpd/conf/.htgroup		//创建一个组文件</span><br><span class="line"></span><br><span class="line">admin:amdin1 admin2</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">42</span>:<span class="number">59</span> <span class="type">root</span>@<span class="type">yc</span> /<span class="type">etc</span>/<span class="type">httpd</span>/<span class="type">conf</span>]<span class="variable">$</span> chmod <span class="number">744</span> .htgroup 		//改变文件权限，让其他人可读</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">11</span>:<span class="number">39</span>:<span class="number">59</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> vi /etc/httpd/conf/.htpasswd 		//组密码文件</span><br><span class="line"></span><br><span class="line">admin1:<span class="variable">$apr1</span><span class="variable">$Qj5kCGKd</span><span class="variable">$qPfDi5HDufciCQGCSd29I</span>/</span><br><span class="line">admin2:<span class="variable">$apr1</span><span class="variable">$i</span>/VneyuX<span class="variable">$Nb3m3bLU09F</span>..niq7cH6j/</span><br></pre></td></tr></table></figure></div>
<p><font size="5"><strong>测试</strong></font><br><font size="4">(1).在客户端C:\Windows\System32\drivers\etc\hosts文件中添加ip及域名<br><a href="https://img-blog.csdnimg.cn/20200223120521570.png" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200223120521570.png" class="lazyload"></a><br><font size="4">(2).浏览器进行访问<br><a href="https://img-blog.csdnimg.cn/2020022312064999.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/2020022312064999.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload"></a></font></font></p>
<h3 id="3-实现不同端口访问"><a href="#3-实现不同端口访问" class="headerlink" title="3).实现不同端口访问"></a>3).实现不同端口访问</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">12</span>:<span class="number">13</span>:<span class="number">27</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /etc/httpd/conf.d/httpd-vhosts.conf</span></span><br><span class="line"></span><br><span class="line">Listen <span class="number">8082</span>				//添加监听端口</span><br><span class="line">Listen <span class="number">9092</span></span><br><span class="line">&lt;VirtualHost *:<span class="number">8082</span>&gt;			</span><br><span class="line">        Servername www.test.com</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin1"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin1"</span>&gt;</span><br><span class="line">        AllowOverride none</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line">&lt;VirtualHost *:<span class="number">9092</span>&gt;</span><br><span class="line">        Servername www.test.com</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin2"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin2"</span>&gt;</span><br><span class="line">        AllowOverride none</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="5"><strong>测试</strong></font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">12</span>:<span class="number">29</span>:<span class="number">29</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#systemctl restart httpd.service		//重启服务</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">12</span>:<span class="number">30</span>:<span class="number">06</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl www.test.com:8082</span></span><br><span class="line">this is admin1</span><br><span class="line">[<span class="number">12</span>:<span class="number">30</span>:<span class="number">09</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl www.test.com:9092</span></span><br><span class="line">this is admin2</span><br></pre></td></tr></table></figure></div>
<h3 id="3-实现不同IP访问"><a href="#3-实现不同IP访问" class="headerlink" title="3).实现不同IP访问"></a>3).实现不同IP访问</h3><p><font size="4">(1).网卡添加ip地址</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">26</span>:<span class="number">00</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#ifconfig ens33:1 192.168.3.4/24</span></span><br></pre></td></tr></table></figure></div>
<p><font size="4">(2).配置文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">35</span>:<span class="number">05</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /etc/httpd/conf.d/httpd-vhosts.conf </span></span><br><span class="line"></span><br><span class="line">&lt;VirtualHost <span class="number">192.168</span>.<span class="number">3.3</span>:<span class="number">80</span>&gt;</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin1"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin1"</span>&gt;</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line">&lt;VirtualHost <span class="number">192.168</span>.<span class="number">3.4</span>:<span class="number">80</span>&gt;</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin2"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin2"</span>&gt;</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="5"><strong>测试</strong></font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">34</span>:<span class="number">23</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#systemctl restart httpd.service</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">37</span>:<span class="number">20</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl 192.168.3.3</span></span><br><span class="line">this is admin1</span><br><span class="line">[<span class="number">14</span>:<span class="number">39</span>:<span class="number">35</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl 192.168.3.4</span></span><br><span class="line">this is admin2</span><br></pre></td></tr></table></figure></div>
<h3 id="4-实现不同域名访问"><a href="#4-实现不同域名访问" class="headerlink" title="4).实现不同域名访问"></a>4).实现不同域名访问</h3><p><font size="4">(1).配置文件</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">14</span>:<span class="number">39</span>:<span class="number">37</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /etc/httpd/conf.d/httpd-vhosts.conf </span></span><br><span class="line"></span><br><span class="line">&lt;VirtualHost *:<span class="number">80</span>&gt;</span><br><span class="line">        Servername www.test.com</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin1"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin1"</span>&gt;</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line">&lt;VirtualHost *:<span class="number">80</span>&gt;</span><br><span class="line">        Servername www1.test.com</span><br><span class="line">        DocumentRoot <span class="string">"/app/admin/admin2"</span></span><br><span class="line">        &lt;Directory <span class="string">"/app/admin/admin2"</span>&gt;</span><br><span class="line">        Require all granted</span><br><span class="line">        &lt;/Directory&gt;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>
<p><font size="4">(2).添加域名</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">15</span>:<span class="number">08</span>:<span class="number">30</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /var/named/test.zone 			//正向文件</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com    root.test.com. (</span><br><span class="line">                                        <span class="number">0</span>       ; serial</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh</span><br><span class="line">                                        <span class="number">1</span>H      ; retry</span><br><span class="line">                                        <span class="number">1</span>W      ; expire</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum</span><br><span class="line">        <span class="keyword">IN</span>      NS      www.test.com.</span><br><span class="line">www     <span class="keyword">IN</span>      A       <span class="number">192.168</span>.<span class="number">3.3</span></span><br><span class="line">www1    <span class="keyword">IN</span>      A       <span class="number">192.168</span>.<span class="number">3.3</span></span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">15</span>:<span class="number">11</span>:<span class="number">01</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#vi /var/named/192.168.19.local 	//反向文件</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com    root.test.com.(</span><br><span class="line">                                        <span class="number">0</span>       ; serial</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh</span><br><span class="line">                                        <span class="number">1</span>H      ; retry</span><br><span class="line">                                        <span class="number">1</span>W      ; expire</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum</span><br><span class="line">        <span class="keyword">IN</span>      NS      test.com.</span><br><span class="line"><span class="number">3</span>       <span class="keyword">IN</span>      PTR     www.test.com.</span><br><span class="line"><span class="number">3</span>       <span class="keyword">IN</span>      PTR     www1.test.com.</span><br></pre></td></tr></table></figure></div>
<p><font size="5"><strong>测试</strong></font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">15</span>:<span class="number">00</span>:<span class="number">20</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#systemctl restart named.service</span></span><br><span class="line">[<span class="number">15</span>:<span class="number">00</span>:<span class="number">22</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#systemctl restart httpd.service</span></span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">15</span>:<span class="number">08</span>:<span class="number">23</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl www.test.com</span></span><br><span class="line">this is admin1</span><br><span class="line">[<span class="number">15</span>:<span class="number">08</span>:<span class="number">28</span> <span class="type">root</span>@<span class="type">localhost</span>~]<span class="comment">#curl www1.test.com</span></span><br><span class="line">this is admin2</span><br></pre></td></tr></table></figure></div>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>Redhat配置yum源</title>
    <url>/2020/02/21/Redhat%E9%85%8D%E7%BD%AEyum%E6%BA%90/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Redhat7-X配置yum源"><a href="#Redhat7-X配置yum源" class="headerlink" title="Redhat7.X配置yum源"></a>Redhat7.X配置yum源</h1><p><font face="黑体" size="4">因为Redhat系统不再起官网注册，系统安装完成后无法正常使用yum源，所以将其Redhat yum源修改为CentOS yum源。</font></p>
<h2 id="1-删除redhat自带yum源"><a href="#1-删除redhat自带yum源" class="headerlink" title="1.删除redhat自带yum源"></a>1.删除redhat自带yum源</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">rm <span class="literal">-rf</span> /etc/rpm/./m*</span><br></pre></td></tr></table></figure></div>
<h2 id="2-从阿里云下载yum相关安装包"><a href="#2-从阿里云下载yum相关安装包" class="headerlink" title="2.从阿里云下载yum相关安装包"></a>2.从阿里云下载yum相关安装包</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">wget https://mirrors.aliyun.com/centos/<span class="number">7</span>/os/x86_64/Packages/yum<span class="literal">-metadata</span><span class="literal">-parser</span><span class="literal">-1</span>.<span class="number">1.4</span><span class="literal">-10</span>.el7.x86_64.rpm</span><br><span class="line">wget https://mirrors.aliyun.com/centos/<span class="number">7</span>/os/x86_64/Packages/yum<span class="literal">-utils</span><span class="literal">-1</span>.<span class="number">1.31</span><span class="literal">-52</span>.el7.noarch.rpm</span><br><span class="line">wget https://mirrors.aliyun.com/centos/<span class="number">7</span>/os/x86_64/Packages/yum<span class="literal">-3</span>.<span class="number">4.3</span><span class="literal">-163</span>.el7.centos.noarch.rpm</span><br><span class="line">wget https://mirrors.aliyun.com/centos/<span class="number">7</span>/os/x86_64/Packages/yum<span class="literal">-plugin</span><span class="literal">-fastestmirror</span><span class="literal">-1</span>.<span class="number">1.31</span><span class="literal">-52</span>.el7.noarch.rpm</span><br><span class="line">wget https://mirrors.aliyun.com/centos/<span class="number">7</span>/os/x86_64/Packages/python<span class="literal">-urlgrabber</span><span class="literal">-3</span>.<span class="number">10</span><span class="literal">-9</span>.el7.noarch.rpm</span><br></pre></td></tr></table></figure></div>
<h2 id="3-强制安装rpm包"><a href="#3-强制安装rpm包" class="headerlink" title="3.强制安装rpm包"></a>3.强制安装rpm包</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">rpm <span class="literal">-ivh</span> python<span class="literal">-urlgrabber</span><span class="literal">-3</span>.<span class="number">10</span><span class="literal">-8</span>.el7.noarch.rpm -<span class="literal">-force</span> -<span class="literal">-nodeps</span></span><br><span class="line"></span><br><span class="line">rpm <span class="literal">-ivh</span> yum* -<span class="literal">-force</span> -<span class="literal">-nodeps</span></span><br></pre></td></tr></table></figure></div>
<h2 id="4-下载yum源"><a href="#4-下载yum源" class="headerlink" title="4.下载yum源"></a>4.下载yum源</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">wget <span class="literal">-o</span> /etc/yum.repos.d/CentOS<span class="literal">-Base</span>.repo http://mirrors.aliyun.com/repo/Centos<span class="literal">-7</span>.repo</span><br></pre></td></tr></table></figure></div>
<h2 id="5-修改yum源文件"><a href="#5-修改yum源文件" class="headerlink" title="5.修改yum源文件"></a>5.修改yum源文件</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/yum.repos.d/CentOS<span class="literal">-Base</span>.repo</span><br></pre></td></tr></table></figure></div>
<p><font face="黑体" size="4">在vim中执行“:%s/$releasever/7/g”替换关键字</font></p>
<h2 id="6-清空重载yum缓存"><a href="#6-清空重载yum缓存" class="headerlink" title="6.清空重载yum缓存"></a>6.清空重载yum缓存</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br><span class="line">yum update</span><br></pre></td></tr></table></figure></div>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>PXE自动批量安装linux系统</title>
    <url>/2020/02/20/PXE%E8%87%AA%E5%8A%A8%E6%89%B9%E9%87%8F%E5%AE%89%E8%A3%85linux%E7%B3%BB%E7%BB%9F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="PXE批量安装Linux"><a href="#PXE批量安装Linux" class="headerlink" title="PXE批量安装Linux"></a>PXE批量安装Linux</h1><h2 id="准备："><a href="#准备：" class="headerlink" title="准备："></a>准备：</h2><p><font size="4">主服务器：1.安装CentOS<br>　　　　　２.安装DHCP，给客户端配置ip<br>　　　　　３.安装TFTP传输引导文件<br>　　　　　４.安装http，提供下载<br>　　　　　</font></p>
<h2 id="1-配置服务端网络"><a href="#1-配置服务端网络" class="headerlink" title="1.配置服务端网络"></a>1.配置服务端网络</h2><h3 id="1-网络连接方式改为“仅主机”"><a href="#1-网络连接方式改为“仅主机”" class="headerlink" title="1).网络连接方式改为“仅主机”"></a>1).网络连接方式改为“仅主机”</h3><p><a href="https://img-blog.csdnimg.cn/20200220125403205.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200220125403205.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
<h3 id="2-配置本地网络"><a href="#2-配置本地网络" class="headerlink" title="2). 配置本地网络"></a>2). 配置本地网络</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/sysconfig/network<span class="literal">-scripts</span>/ifcfg<span class="literal">-ens33</span></span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=<span class="keyword">static</span>   //设置为静态</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable<span class="literal">-privacy</span></span><br><span class="line">NAME=ens33</span><br><span class="line">UUID=e1d9fa74<span class="literal">-1031</span><span class="literal">-495e</span><span class="literal">-868d</span><span class="literal">-78b1739ee001</span></span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=yes		</span><br><span class="line">IPV6_PRIVACY=no</span><br><span class="line">IPADDR=<span class="number">192.168</span>.<span class="number">3.2</span></span><br><span class="line">PREFIX=<span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">GATEWAY=<span class="number">192.168</span>.<span class="number">3.1</span></span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">systemctl restart network     //重新启动网络 </span><br><span class="line">systemctl enable network 	  //加入开机自启动项</span><br><span class="line">systemctl stop firewalld.service	  //关闭防火墙</span><br><span class="line">systemctl disable firewalld.service   //关闭开机自启动</span><br><span class="line">chkconfig -<span class="literal">-list</span>			  //查看开机自启动项列表</span><br><span class="line">setenforce <span class="number">0</span>				  //关闭selinux</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/sysconfig/selinux		//修改selinux</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># This file controls the state of SELinux on the system.</span></span><br><span class="line"><span class="comment"># SELINUX= can take one of these three values:</span></span><br><span class="line"><span class="comment">#     enforcing - SELinux security policy is enforced.</span></span><br><span class="line"><span class="comment">#     permissive - SELinux prints warnings instead of enforcing.</span></span><br><span class="line"><span class="comment">#     disabled - No SELinux policy is loaded.</span></span><br><span class="line">SELINUX=disabled 		//关闭开机自启动</span><br><span class="line"><span class="comment"># SELINUXTYPE= can take one of three two values:</span></span><br><span class="line"><span class="comment">#     targeted - Targeted processes are protected,</span></span><br><span class="line"><span class="comment">#     minimum - Modification of targeted policy. Only selected processes are protected.</span></span><br><span class="line"><span class="comment">#     mls - Multi Level Security protection.</span></span><br><span class="line">SELINUXTYPE=targeted</span><br></pre></td></tr></table></figure></div>
<h2 id="2-安装服务"><a href="#2-安装服务" class="headerlink" title="2.安装服务"></a>2.安装服务</h2><h3 id="1-挂载光盘"><a href="#1-挂载光盘" class="headerlink" title="1).挂载光盘"></a>1).挂载光盘</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">mkdir /mnt/cdrom		//建立挂载点</span><br><span class="line">mount /dev/sr0 /mnt/cdrom/	//挂载</span><br></pre></td></tr></table></figure></div>
<h3 id="2-配置yum源"><a href="#2-配置yum源" class="headerlink" title="2).配置yum源"></a>2).配置yum源</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">cd /etc/yum.repos.d/	</span><br><span class="line">tar <span class="literal">-czvf</span> repo_bak *.repo	//备份原yum源</span><br><span class="line">vi CentOS7.repo		//新建本地yum源</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="type">CentOS7</span>]</span><br><span class="line">name=CentOS		//命名</span><br><span class="line">baseurl=file:///mnt/cdrom/		//iso镜像目录</span><br><span class="line">gpgcheck=<span class="number">0</span>				//是否进行安全校验</span><br><span class="line">enable=<span class="number">1</span>				//启动yum源</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum clean all    		//清除原yum缓存</span><br><span class="line">yum makecache			//新建yum缓存</span><br></pre></td></tr></table></figure></div>
<h3 id="3-配置DHCP服务"><a href="#3-配置DHCP服务" class="headerlink" title="3).配置DHCP服务"></a>3).配置DHCP服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install dhcp		//安装dhcp服务</span><br><span class="line">vi /etc/dhcp/dhcpd.conf		//修改配置文件</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># DHCP Server Configuration file.</span></span><br><span class="line"><span class="comment">#   see /usr/share/doc/dhcp*/dhcpd.conf<span class="doctag">.example</span></span></span><br><span class="line"><span class="comment">#   see dhcpd.conf(5) man page</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">allow booting;		//允许dhcp服务给没有安装操作系统的服务器分配ip</span><br><span class="line">allow bootp;</span><br><span class="line">ddns<span class="literal">-update</span><span class="literal">-style</span> interim;</span><br><span class="line">ignore client<span class="literal">-updates</span>;</span><br><span class="line">subnet <span class="number">192.168</span>.<span class="number">3.0</span> netmask <span class="number">255.255</span>.<span class="number">255.0</span> &#123;</span><br><span class="line">        option subnet<span class="literal">-mask</span> <span class="number">255.255</span>.<span class="number">255.0</span>;</span><br><span class="line">        option domain<span class="literal">-name</span><span class="literal">-servers</span> <span class="number">192.168</span>.<span class="number">3.2</span>;</span><br><span class="line">        range   <span class="number">192.168</span>.<span class="number">3.100</span>   <span class="number">192.168</span>.<span class="number">3.200</span>;</span><br><span class="line">        dafault<span class="literal">-lease</span><span class="literal">-time</span> <span class="number">21600</span>;</span><br><span class="line">        next<span class="literal">-server</span> <span class="number">192.168</span>.<span class="number">3.2</span>;	</span><br><span class="line">        filename <span class="string">"pxelinux.0"</span>;		//	引导文件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">systemctl restart dhcpd.service			//重启dhcp服务</span><br><span class="line">systemctl enable dhcpd.service			//加入开机自启动</span><br></pre></td></tr></table></figure></div>
<h3 id="4-配置TFTP服务-简单文本传输协议"><a href="#4-配置TFTP服务-简单文本传输协议" class="headerlink" title="4).配置TFTP服务(简单文本传输协议)"></a>4).配置TFTP服务<font size="3">(简单文本传输协议)</font></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install tftp<span class="literal">-server</span>		</span><br><span class="line">yum install xinetd		//安装依赖的xinetd服务</span><br><span class="line">vi /etc/xinetd.d/tftp</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># default: off</span></span><br><span class="line"><span class="comment"># description: The tftp server serves files using the trivial file transfer \</span></span><br><span class="line"><span class="comment">#       protocol.  The tftp protocol is often used to boot diskless \</span></span><br><span class="line"><span class="comment">#       workstations, download configuration files to network-aware printers, \</span></span><br><span class="line"><span class="comment">#       and to start the installation process for some operating systems.</span></span><br><span class="line">service tftp</span><br><span class="line">&#123;</span><br><span class="line">        socket_type             = dgram</span><br><span class="line">        protocol                = udp</span><br><span class="line">        wait                    = yes</span><br><span class="line">        user                    = root</span><br><span class="line">        server                  = /usr/sbin/in.tftpd</span><br><span class="line">        server_args             = <span class="literal">-s</span> /var/lib/tftpboot</span><br><span class="line">        disable                 = no 			//设置为no</span><br><span class="line">        per_source              = <span class="number">11</span></span><br><span class="line">        cps                     = <span class="number">100</span> <span class="number">2</span></span><br><span class="line">        flags                   = IPv4</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">systemctl restart xinetd.service </span><br><span class="line">systemctl enable xinetd.service</span><br></pre></td></tr></table></figure></div>
<h3 id="5-安装syslinux服务-开机获取引导文件"><a href="#5-安装syslinux服务-开机获取引导文件" class="headerlink" title="5).安装syslinux服务(开机获取引导文件)"></a>5).安装syslinux服务<font size="3">(开机获取引导文件)</font></h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum <span class="literal">-y</span> install syslinux</span><br></pre></td></tr></table></figure></div>
<h3 id="6-文件处理"><a href="#6-文件处理" class="headerlink" title="6).文件处理"></a>6).文件处理</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">cp <span class="literal">-a</span> /usr/share/syslinux/pxelinux.<span class="number">0</span>  /var/lib/tftpboot/		//复制引导文件</span><br><span class="line">cp <span class="literal">-a</span> /mnt/cdrom/images/pxeboot/initrd.img  /var/lib/tftpboot/</span><br><span class="line">cp <span class="literal">-a</span> /mnt/cdrom/images/pxeboot/vmlinuz  /var/lib/tftpboot/</span><br><span class="line">cp <span class="literal">-a</span> /mnt/cdrom/isolinux/boot.msg  /var/lib/tftpboot/</span><br><span class="line">cp <span class="literal">-a</span> /mnt/cdrom/isolinux/vesamenu.c32  /var/lib/tftpboot/</span><br><span class="line">mkdir /var/lib/tftpboot/pxelinux.cfg</span><br><span class="line">cp <span class="literal">-a</span> /mnt/cdrom/isolinux/isolinux.cfg  /var/lib/tftpboot/pxelinux.cfg/default  //更改文件名为“default”</span><br><span class="line">vi /var/lib/tftpboot/pxelinux.cfg/default</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">default linux    		//添加引导选项</span><br><span class="line"><span class="comment">#default vesamenu.c32   //注释掉</span></span><br><span class="line">timeout <span class="number">600</span></span><br><span class="line">display boot.msg</span><br><span class="line">			.......</span><br><span class="line">label linux</span><br><span class="line">  menu label ^Install CentOS <span class="number">7</span></span><br><span class="line">  kernel vmlinuz</span><br><span class="line">  append initrd=initrd.img  ks=http://<span class="number">192.168</span>.<span class="number">3.2</span>/ks.cfg		//添加引导信息</span><br><span class="line"><span class="comment">#append initrd=initrd.img inst.stage2=hd:LABEL=CentOS\x207\x20x86_64 quiet	//注释</span></span><br><span class="line">			.......</span><br></pre></td></tr></table></figure></div>
<h3 id="7-配置http服务"><a href="#7-配置http服务" class="headerlink" title="7).配置http服务"></a>7).配置http服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install httpd</span><br><span class="line">cp <span class="literal">-a</span> /root/anaconda<span class="literal">-ks</span>.cfg    /var/www/html/ks.cfg</span><br><span class="line">vi ks.cfg</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment">#version=DEVEL</span></span><br><span class="line"><span class="comment"># System authorization information</span></span><br><span class="line">auth -<span class="literal">-enableshadow</span> -<span class="literal">-passalgo</span>=sha512</span><br><span class="line"><span class="comment"># Use CDROM installation media</span></span><br><span class="line">url  -<span class="literal">-url</span>=http://<span class="number">192.168</span>.<span class="number">3.2</span>/cdrom       //添加镜像地址</span><br><span class="line"><span class="comment"># Use graphical install</span></span><br><span class="line">graphical</span><br><span class="line">		......</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">chown apache:apache ks.cfg					//修改ks.cfg文件组和属组为apache</span><br><span class="line">mkdir /var/www/html/cdrom					//建立挂载点</span><br><span class="line">mount /dev/sr0 /var/www/html/cdrom			//挂载</span><br><span class="line">systemctl restart httpd.service				//重新启动服务</span><br><span class="line">systemctl enable httpd.service				//加入开机自启动</span><br></pre></td></tr></table></figure></div>
<h2 id="3-客户端测试"><a href="#3-客户端测试" class="headerlink" title="3.客户端测试"></a>3.客户端测试</h2><p><font size="4">1).设置网络连接方式为“仅主机”<br> 2).CentOS7.3 以上内存必须要大于2G<br> 3).CD里面不放镜像，直接开机</font><br><a href="https://img-blog.csdnimg.cn/20200220215626217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200220215626217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>Liunx—搭建DHCP服务器</title>
    <url>/2020/02/18/Liunx%E2%80%94%E6%90%AD%E5%BB%BADHCP%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Linux搭建DHCP服务器"><a href="#Linux搭建DHCP服务器" class="headerlink" title="Linux搭建DHCP服务器 "></a><center>Linux搭建DHCP服务器 </center></h1><h5 id="准备："><a href="#准备：" class="headerlink" title="准备："></a>准备：</h5><p><font size="4">以虚拟Linux主机作为服务端，虚拟Windows主机作为客户端，所以两台主机都以“仅主机模式”的网络连接方式进行连接：</font><br><a href="https://img-blog.csdnimg.cn/20200218213720814.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70#pic_center=30*30" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218213720814.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70#pic_center=30*30" class="lazyload"></a></p>
<h2 id="1-服务端配置"><a href="#1-服务端配置" class="headerlink" title="1.服务端配置"></a>1.服务端配置</h2><h3 id="1-安装DHCP服务"><a href="#1-安装DHCP服务" class="headerlink" title="1).安装DHCP服务"></a>1).安装DHCP服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install dhcp</span><br></pre></td></tr></table></figure></div>
<h3 id="2-配置DHCP服务的主配置文件"><a href="#2-配置DHCP服务的主配置文件" class="headerlink" title="2).配置DHCP服务的主配置文件"></a>2).配置DHCP服务的主配置文件</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/dhcp/dhcpd.conf					//这是dhcp的主要配置文件（默认为空）</span><br><span class="line">cp /usr/share/doc/dhcp<span class="literal">-4</span>.<span class="number">2.5</span>/dhcpd.conf.example /etc/dhcp/dhcp.conf		//将dhcp的模板文件替换成主配置文件</span><br></pre></td></tr></table></figure></div>
<h3 id="3-编辑主配置文件"><a href="#3-编辑主配置文件" class="headerlink" title="3).编辑主配置文件"></a>3).编辑主配置文件</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">subnet <span class="number">192.170</span>.<span class="number">70.0</span>  netmask <span class="number">255.255</span>.<span class="number">255.0</span> &#123;     		//声明网段，子网掩码</span><br><span class="line">  range <span class="number">192.170</span>.<span class="number">70.1</span> <span class="number">192.170</span>.<span class="number">70.200</span>;					//地址池分配地址范围</span><br><span class="line">  option domain<span class="literal">-name</span><span class="literal">-servers</span> <span class="number">192.170</span>.<span class="number">70.137</span>;		 	//分配的dns服务器地址</span><br><span class="line">  option domain<span class="literal">-name</span> <span class="string">"test.cn"</span>;					 		//分配的域名</span><br><span class="line">  option routers <span class="number">172.170</span>.<span class="number">70.137</span>;					 	//设置网关</span><br><span class="line">  default<span class="literal">-lease</span><span class="literal">-time</span> <span class="number">600</span>;						 		//缺省（默认）租约时间</span><br><span class="line">  max<span class="literal">-lease</span><span class="literal">-time</span> <span class="number">7200</span>;							 		//最大租约时间</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="4-重启DHCP服务"><a href="#4-重启DHCP服务" class="headerlink" title="4).重启DHCP服务"></a>4).重启DHCP服务</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">systemctl restart dhcpd.service</span><br></pre></td></tr></table></figure></div>
<h3 id="5-查看端口状态"><a href="#5-查看端口状态" class="headerlink" title="5).查看端口状态"></a>5).查看端口状态</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">netstat <span class="literal">-anput</span> | grep <span class="number">67</span></span><br><span class="line">udp        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">67</span>              <span class="number">0.0</span>.<span class="number">0.0</span>:*                           <span class="number">3592</span>/dhcpd </span><br><span class="line">//dhcp使用的是c/s传输模式，所以查看upd协议的<span class="number">67</span>号端口</span><br></pre></td></tr></table></figure></div>
<h2 id="2-客户端配置"><a href="#2-客户端配置" class="headerlink" title="2.客户端配置"></a>2.客户端配置</h2><h4 id="1-将网卡设置为自动获取ip地址："><a href="#1-将网卡设置为自动获取ip地址：" class="headerlink" title="1).将网卡设置为自动获取ip地址："></a>1).将网卡设置为自动获取ip地址：</h4><p><a href="https://img-blog.csdnimg.cn/20200218222737536.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218222737536.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
<h4 id="2-释放ip地址"><a href="#2-释放ip地址" class="headerlink" title="2).释放ip地址"></a>2).释放ip地址</h4><p><a href="https://img-blog.csdnimg.cn/20200218223420263.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218223420263.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
<h4 id="3-从主机重新获取ip"><a href="#3-从主机重新获取ip" class="headerlink" title="3).从主机重新获取ip"></a>3).从主机重新获取ip</h4><p><a href="https://img-blog.csdnimg.cn/20200218223651137.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218223651137.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload"></a><br><font size="4">已经获取到了dhcp服务器动态分配的地址</font></p>
<h2 id="3-客户端分配静态的ip地址"><a href="#3-客户端分配静态的ip地址" class="headerlink" title="3.客户端分配静态的ip地址"></a>3.客户端分配静态的ip地址</h2><h4 id="1-找到网卡的MAC地址："><a href="#1-找到网卡的MAC地址：" class="headerlink" title="1).找到网卡的MAC地址："></a>1).找到网卡的MAC地址：</h4><p><a href="https://img-blog.csdnimg.cn/20200218225129298.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218225129298.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
<h4 id="2-修改服务端的配置文件："><a href="#2-修改服务端的配置文件：" class="headerlink" title="2).修改服务端的配置文件："></a>2).修改服务端的配置文件：</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">vi /etc/dhcp/dhcpd.conf</span><br></pre></td></tr></table></figure></div>

<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">host fantasia &#123;				//文件内能找到</span><br><span class="line">  hardware ethernet <span class="number">00</span><span class="literal">-0C</span><span class="literal">-29</span><span class="literal">-8D</span><span class="literal">-49</span><span class="literal">-0C</span>;		//客户端的MAC地址</span><br><span class="line">  fixed<span class="literal">-address</span> <span class="number">192.168</span>.<span class="number">70.140</span>;				//给客户端分配的静态ip</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<h4 id="3-客户端进行测试"><a href="#3-客户端进行测试" class="headerlink" title="3).客户端进行测试"></a>3).客户端进行测试</h4><p><a href="https://img-blog.csdnimg.cn/20200218230112365.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" data-fancybox="group" data-caption="在这里插入图片描述" class="fancybox"><img alt="在这里插入图片描述" title="在这里插入图片描述" data-src="https://img-blog.csdnimg.cn/20200218230112365.JPG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsNjY2NjY2Njc=,size_16,color_FFFFFF,t_70" class="lazyload"></a></p>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
  <entry>
    <title>Linux—搭建DNS服务器</title>
    <url>/2020/02/08/Linux%E2%80%94%E6%90%AD%E5%BB%BADNS%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Linux搭建DNS服务器教程"><a href="#Linux搭建DNS服务器教程" class="headerlink" title="Linux搭建DNS服务器教程"></a><center>Linux搭建DNS服务器教程</center></h1><h2 id="1-安装bind"><a href="#1-安装bind" class="headerlink" title="1.安装bind"></a>1.安装bind</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install bind</span><br></pre></td></tr></table></figure></div>

<h2 id="2-修改named-conf配置文件"><a href="#2-修改named-conf配置文件" class="headerlink" title="2.修改named.conf配置文件"></a>2.修改named.conf配置文件</h2><p><font size="4">vi /etc/named.conf 下的</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">options &#123;</span><br><span class="line">       listen<span class="literal">-on</span> port <span class="number">53</span> &#123; any; &#125;; //所有服务都能监听<span class="number">53</span>这个端口</span><br><span class="line">       listen<span class="literal">-on</span><span class="literal">-v6</span> port <span class="number">53</span> &#123; ::<span class="number">1</span>; &#125;;</span><br><span class="line">       directory       <span class="string">"/var/named"</span>;</span><br><span class="line">       dump<span class="operator">-file</span>       <span class="string">"/var/named/data/cache_dump.db"</span>;</span><br><span class="line">       statistics<span class="operator">-file</span> <span class="string">"/var/named/data/named_stats.txt"</span>;</span><br><span class="line">       memstatistics<span class="operator">-file</span> <span class="string">"/var/named/data/named_mem_stats.txt"</span>;</span><br><span class="line">       recursing<span class="operator">-file</span>  <span class="string">"/var/named/data/named.recursing"</span>;</span><br><span class="line">       secroots<span class="operator">-file</span>   <span class="string">"/var/named/data/named.secroots"</span>;</span><br><span class="line">       allow<span class="literal">-query</span>     &#123; any; &#125;; //表示所有人都可以访问这台dns服务器</span><br><span class="line">       forwarders		&#123; <span class="number">192.168</span>.<span class="number">19.140</span>; &#125;; //添加后，本地dns主机解析外网网站</span><br></pre></td></tr></table></figure></div>
<p><font size="3">测试配置是否正确：</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">named<span class="literal">-checkconf</span> /etc/named.conf</span><br></pre></td></tr></table></figure></div>

<h2 id="3-配置named-rfc1912-zones文件"><a href="#3-配置named-rfc1912-zones文件" class="headerlink" title="3.配置named.rfc1912.zones文件"></a>3.配置named.rfc1912.zones文件</h2><p><font size="3">添加正向解析: </font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">zone <span class="string">"test.com"</span> <span class="keyword">IN</span> &#123;	//域名	</span><br><span class="line">        type master;	//服务类型：主服务器</span><br><span class="line">        file <span class="string">"test.com.zone"</span>;  //域名与ip地址解析规则保存文件</span><br><span class="line">        allow<span class="literal">-update</span> &#123; none; &#125;; //允许那些客户机动态更新解析信息</span><br><span class="line">&#125;;	//结尾分号不能少</span><br></pre></td></tr></table></figure></div>
<p><font size="3">添加反向解析: </font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">zone <span class="string">"0.17.172.in-addr.arpa"</span> <span class="keyword">IN</span> &#123;	//表示<span class="number">172.17</span>.<span class="number">0.0</span>/<span class="number">24</span>网段的反向解析区域</span><br><span class="line">        type master;</span><br><span class="line">        file <span class="string">"172.17.0.local"</span>;</span><br><span class="line">        allow<span class="literal">-update</span> &#123; none; &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>
<h2 id="4-编辑正向-反向解析配置文件"><a href="#4-编辑正向-反向解析配置文件" class="headerlink" title="4.编辑正向/反向解析配置文件"></a>4.编辑正向/反向解析配置文件</h2><h3 id="（1）在-var-named-下分别建立-test-com-zone-和172-17-0-local-文件"><a href="#（1）在-var-named-下分别建立-test-com-zone-和172-17-0-local-文件" class="headerlink" title="（1）在/var/named/下分别建立 test.com.zone 和172.17.0.local 文件"></a>（1）在/var/named/下分别建立 test.com.zone 和172.17.0.local 文件</h3><p>可直接：<br><font size="3">cp -p named.localhost    test.com.zone<br>cp -p named.loopback  172.17.0.local </font></p>
<h3 id="（2）编辑test-com-zone："><a href="#（2）编辑test-com-zone：" class="headerlink" title="（2）编辑test.com.zone："></a>（2）编辑test.com.zone：</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D		//生存周期为<span class="number">1</span>天</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com.   root.test.com.(		</span><br><span class="line">                                        <span class="number">0</span>       ; serial	//更新序列号</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh	//更新时间</span><br><span class="line">                                        <span class="number">1</span>H      ; retry		//重试时间</span><br><span class="line">                                        <span class="number">1</span>W      ; expire	//失效时间</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum	//无效解析记录的缓存时间</span><br><span class="line">        <span class="keyword">IN</span>      NS      www.test.com.</span><br><span class="line">www     <span class="keyword">IN</span>      A       <span class="number">172.17</span>.<span class="number">0.1</span>	//正向解析</span><br><span class="line">ftp     <span class="keyword">IN</span>      A       <span class="number">172.17</span>.<span class="number">0.2</span></span><br></pre></td></tr></table></figure></div>
<h3 id="（3）编辑172-17-0-local："><a href="#（3）编辑172-17-0-local：" class="headerlink" title="（3）编辑172.17.0.local："></a>（3）编辑172.17.0.local：</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com    root.test.com. (</span><br><span class="line">                                        <span class="number">0</span>       ; serial</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh</span><br><span class="line">                                        <span class="number">1</span>H      ; retry</span><br><span class="line">                                        <span class="number">1</span>W      ; expire</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum</span><br><span class="line">        <span class="keyword">IN</span>      NS      www.test.com.</span><br><span class="line"><span class="number">1</span>       <span class="keyword">IN</span>      PTR     www.test.com.	//反向解析</span><br><span class="line"><span class="number">2</span>       <span class="keyword">IN</span>      PTR     ftp.test.com.</span><br></pre></td></tr></table></figure></div>

<p><font size="3">测试配置是否正确：</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">named<span class="literal">-checkconf</span> /var/named/test.com.zone</span><br><span class="line">named<span class="literal">-checkconf</span> /var/named/<span class="number">172.17</span>.<span class="number">0</span>.local</span><br></pre></td></tr></table></figure></div>
<h2 id="5-添加本地DNS"><a href="#5-添加本地DNS" class="headerlink" title="5.添加本地DNS"></a>5.添加本地DNS</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">; generated by /usr/sbin/dhclient<span class="literal">-script</span></span><br><span class="line">nameserver <span class="number">172.17</span>.<span class="number">0.15</span>		//新建DNS服务器地址（本地ip）查询优先级自上而下</span><br><span class="line">nameserver <span class="number">183.60</span>.<span class="number">83.19</span>		</span><br><span class="line">nameserver <span class="number">183.60</span>.<span class="number">82.98</span></span><br></pre></td></tr></table></figure></div>
<p><font size="3"> 重启dns服务：</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">sysytemctl	restart	named.service</span><br></pre></td></tr></table></figure></div>

<h2 id="6-通过nslookup进行解析"><a href="#6-通过nslookup进行解析" class="headerlink" title="6.通过nslookup进行解析"></a>6.通过nslookup进行解析</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">16</span>:<span class="number">21</span>:<span class="number">08</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> nslookup</span><br><span class="line">&gt; www.test.com</span><br><span class="line">Server:		<span class="number">172.17</span>.<span class="number">0.15</span></span><br><span class="line">Address:	<span class="number">172.17</span>.<span class="number">0.15</span></span><br><span class="line"></span><br><span class="line">Name:	www.test.com</span><br><span class="line">Address: <span class="number">172.17</span>.<span class="number">0.1</span></span><br><span class="line">&gt; <span class="number">172.17</span>.<span class="number">0.2</span></span><br><span class="line"><span class="number">2.0</span>.<span class="number">17.172</span>.in<span class="literal">-addr</span>.arpa	name = ftp.test.com.</span><br></pre></td></tr></table></figure></div>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
</search>
