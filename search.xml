<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>photo</title>
    <url>/2020/02/08/photo/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><div class="justified-gallery"><p><a href="C:%5CUsers%5CWL%5CDesktop%5Cbolg%5Cblog%5Cthemes%5CButterfly%5Csource%5Cimg%5Cfirst.jpg" data-fancybox="group" data-caption class="fancybox"><img src="C:%5CUsers%5CWL%5CDesktop%5Cbolg%5Cblog%5Cthemes%5CButterfly%5Csource%5Cimg%5Cfirst.jpg" alt title></a></p>

          </div>]]></content>
  </entry>
  <entry>
    <title>Linux搭建DNS服务器</title>
    <url>/2020/02/08/Linux%E6%90%AD%E5%BB%BADNS%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><hr>
<h1 id="Linux搭建DNS服务器教程"><a href="#Linux搭建DNS服务器教程" class="headerlink" title="Linux搭建DNS服务器教程"></a><center>Linux搭建DNS服务器教程</center></h1><h2 id="1-安装bind"><a href="#1-安装bind" class="headerlink" title="1.安装bind"></a>1.安装bind</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">yum install bind</span><br></pre></td></tr></table></figure></div>

<h2 id="2-修改named-conf配置文件"><a href="#2-修改named-conf配置文件" class="headerlink" title="2.修改named.conf配置文件"></a>2.修改named.conf配置文件</h2><p><font size="4">vi /etc/named.conf 下的</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">options &#123;</span><br><span class="line">       listen<span class="literal">-on</span> port <span class="number">53</span> &#123; any; &#125;; //所有服务都能监听<span class="number">53</span>这个端口</span><br><span class="line">       listen<span class="literal">-on</span><span class="literal">-v6</span> port <span class="number">53</span> &#123; ::<span class="number">1</span>; &#125;;</span><br><span class="line">       directory       <span class="string">"/var/named"</span>;</span><br><span class="line">       dump<span class="operator">-file</span>       <span class="string">"/var/named/data/cache_dump.db"</span>;</span><br><span class="line">       statistics<span class="operator">-file</span> <span class="string">"/var/named/data/named_stats.txt"</span>;</span><br><span class="line">       memstatistics<span class="operator">-file</span> <span class="string">"/var/named/data/named_mem_stats.txt"</span>;</span><br><span class="line">       recursing<span class="operator">-file</span>  <span class="string">"/var/named/data/named.recursing"</span>;</span><br><span class="line">       secroots<span class="operator">-file</span>   <span class="string">"/var/named/data/named.secroots"</span>;</span><br><span class="line">       allow<span class="literal">-query</span>     &#123; any; &#125;; //表示所有人都可以访问这台dns服务器</span><br><span class="line">       forwarders		&#123; <span class="number">192.168</span>.<span class="number">19.140</span>; &#125;; //添加后，本地dns主机解析外网网站</span><br></pre></td></tr></table></figure></div>
<p><font size="3">测试配置是否正确：</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">named<span class="literal">-checkconf</span> /etc/named.conf</span><br></pre></td></tr></table></figure></div>

<h2 id="3-配置named-rfc1912-zones文件"><a href="#3-配置named-rfc1912-zones文件" class="headerlink" title="3.配置named.rfc1912.zones文件"></a>3.配置named.rfc1912.zones文件</h2><p><font size="3">添加正向解析: </font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">zone <span class="string">"test.com"</span> <span class="keyword">IN</span> &#123;	//域名	</span><br><span class="line">        type master;	//服务类型：主服务器</span><br><span class="line">        file <span class="string">"test.com.zone"</span>;  //域名与ip地址解析规则保存文件</span><br><span class="line">        allow<span class="literal">-update</span> &#123; none; &#125;; //允许那些客户机动态更新解析信息</span><br><span class="line">&#125;;	//结尾分号不能少</span><br></pre></td></tr></table></figure></div>
<p><font size="3">添加反向解析: </font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">zone <span class="string">"0.17.172.in-addr.arpa"</span> <span class="keyword">IN</span> &#123;	//表示<span class="number">172.17</span>.<span class="number">0.0</span>/<span class="number">24</span>网段的反向解析区域</span><br><span class="line">        type master;</span><br><span class="line">        file <span class="string">"172.17.0.local"</span>;</span><br><span class="line">        allow<span class="literal">-update</span> &#123; none; &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>
<h2 id="4-编辑正向-反向解析配置文件"><a href="#4-编辑正向-反向解析配置文件" class="headerlink" title="4.编辑正向/反向解析配置文件"></a>4.编辑正向/反向解析配置文件</h2><h3 id="（1）在-var-named-下分别建立-test-com-zone-和172-17-0-local-文件"><a href="#（1）在-var-named-下分别建立-test-com-zone-和172-17-0-local-文件" class="headerlink" title="（1）在/var/named/下分别建立 test.com.zone 和172.17.0.local 文件"></a>（1）在/var/named/下分别建立 test.com.zone 和172.17.0.local 文件</h3><p>可直接：<br><font size="3">cp -p named.localhost    test.com.zone<br>cp -p named.loopback  172.17.0.local </font></p>
<h3 id="（2）编辑test-com-zone："><a href="#（2）编辑test-com-zone：" class="headerlink" title="（2）编辑test.com.zone："></a>（2）编辑test.com.zone：</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D		//生存周期为<span class="number">1</span>天</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com.   root.test.com.(		</span><br><span class="line">                                        <span class="number">0</span>       ; serial	//更新序列号</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh	//更新时间</span><br><span class="line">                                        <span class="number">1</span>H      ; retry		//重试时间</span><br><span class="line">                                        <span class="number">1</span>W      ; expire	//失效时间</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum	//无效解析记录的缓存时间</span><br><span class="line">        <span class="keyword">IN</span>      NS      www.test.com.</span><br><span class="line">www     <span class="keyword">IN</span>      A       <span class="number">172.17</span>.<span class="number">0.1</span>	//正向解析</span><br><span class="line">ftp     <span class="keyword">IN</span>      A       <span class="number">172.17</span>.<span class="number">0.2</span></span><br></pre></td></tr></table></figure></div>
<h3 id="（3）编辑172-17-0-local："><a href="#（3）编辑172-17-0-local：" class="headerlink" title="（3）编辑172.17.0.local："></a>（3）编辑172.17.0.local：</h3><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$TTL</span> <span class="number">1</span>D</span><br><span class="line"><span class="selector-tag">@</span>       <span class="keyword">IN</span> SOA  www.test.com    root.test.com. (</span><br><span class="line">                                        <span class="number">0</span>       ; serial</span><br><span class="line">                                        <span class="number">1</span>D      ; refresh</span><br><span class="line">                                        <span class="number">1</span>H      ; retry</span><br><span class="line">                                        <span class="number">1</span>W      ; expire</span><br><span class="line">                                        <span class="number">3</span>H )    ; minimum</span><br><span class="line">        <span class="keyword">IN</span>      NS      www.test.com.</span><br><span class="line"><span class="number">1</span>       <span class="keyword">IN</span>      PTR     www.test.com.	//反向解析</span><br><span class="line"><span class="number">2</span>       <span class="keyword">IN</span>      PTR     ftp.test.com.</span><br></pre></td></tr></table></figure></div>

<p><font size="3">测试配置是否正确：</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">named<span class="literal">-checkconf</span> /var/named/test.com.zone</span><br><span class="line">named<span class="literal">-checkconf</span> /var/named/<span class="number">172.17</span>.<span class="number">0</span>.local</span><br></pre></td></tr></table></figure></div>
<h2 id="5-添加本地DNS"><a href="#5-添加本地DNS" class="headerlink" title="5.添加本地DNS"></a>5.添加本地DNS</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">; generated by /usr/sbin/dhclient<span class="literal">-script</span></span><br><span class="line">nameserver <span class="number">172.17</span>.<span class="number">0.15</span>		//新建DNS服务器地址（本地ip）查询优先级自上而下</span><br><span class="line">nameserver <span class="number">183.60</span>.<span class="number">83.19</span>		</span><br><span class="line">nameserver <span class="number">183.60</span>.<span class="number">82.98</span></span><br></pre></td></tr></table></figure></div>
<p><font size="3"> 重启dns服务：</font></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">sysytemctl	restart	named.service</span><br></pre></td></tr></table></figure></div>

<h2 id="6-通过nslookup进行解析"><a href="#6-通过nslookup进行解析" class="headerlink" title="6.通过nslookup进行解析"></a>6.通过nslookup进行解析</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">powershell</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">[<span class="number">16</span>:<span class="number">21</span>:<span class="number">08</span> <span class="type">root</span>@<span class="type">yc</span> ~]<span class="variable">$</span> nslookup</span><br><span class="line">&gt; www.test.com</span><br><span class="line">Server:		<span class="number">172.17</span>.<span class="number">0.15</span></span><br><span class="line">Address:	<span class="number">172.17</span>.<span class="number">0.15</span></span><br><span class="line"></span><br><span class="line">Name:	www.test.com</span><br><span class="line">Address: <span class="number">172.17</span>.<span class="number">0.1</span></span><br><span class="line">&gt; <span class="number">172.17</span>.<span class="number">0.2</span></span><br><span class="line"><span class="number">2.0</span>.<span class="number">17.172</span>.in<span class="literal">-addr</span>.arpa	name = ftp.test.com.</span><br></pre></td></tr></table></figure></div>
<h1 id="成功！！！"><a href="#成功！！！" class="headerlink" title="成功！！！"></a>成功！！！</h1>]]></content>
  </entry>
</search>
